# Доступ к Medicine ERP по локальной сети

Это руководство поможет вам настроить доступ к системе с других компьютеров в локальной сети.

## 1. Узнайте IP адрес компьютера-сервера

### Windows:
```powershell
ipconfig
```
Найдите IPv4 адрес (например: `192.168.1.100`)

### Linux/Mac:
```bash
ip addr show
# или
ifconfig
```

## 2. Настройка переменных окружения

Отредактируйте файл `.env` в корне проекта:

```env
# Замените localhost на IP адрес вашего компьютера
HOST_IP=192.168.1.100

# Пример:
VITE_API_URL=http://192.168.1.100:8000/api/v1
VITE_WS_URL=ws://192.168.1.100:8001
```

## 3. Обновление docker-compose.yml

Файл уже настроен для работы по сети:
- Backend: `0.0.0.0:8000` (доступен со всех интерфейсов)
- Frontend: `0.0.0.0:5173` (доступен со всех интерфейсов)  
- Channels (WebSocket): `0.0.0.0:8001`

## 4. Настройка файрвола (Windows)

### Автоматическое добавление правил:
```powershell
# Запустите PowerShell от имени администратора

# Разрешить порт 5173 (Frontend)
New-NetFirewallRule -DisplayName "Medicine ERP Frontend" -Direction Inbound -LocalPort 5173 -Protocol TCP -Action Allow

# Разрешить порт 8000 (Backend API)
New-NetFirewallRule -DisplayName "Medicine ERP Backend" -Direction Inbound -LocalPort 8000 -Protocol TCP -Action Allow

# Разрешить порт 8001 (WebSocket)
New-NetFirewallRule -DisplayName "Medicine ERP WebSocket" -Direction Inbound -LocalPort 8001 -Protocol TCP -Action Allow
```

### Ручное добавление через UI:
1. Откройте "Панель управления" → "Система и безопасность" → "Брандмауэр Windows"
2. Нажмите "Дополнительные параметры"
3. Выберите "Правила для входящих подключений"
4. Нажмите "Создать правило"
5. Тип правила: "Для порта"
6. Протокол: TCP
7. Порты: 5173, 8000, 8001
8. Действие: Разрешить подключение
9. Когда применять: Все (Доменный, Частный, Публичный)
10. Имя: "Medicine ERP"

## 5. Перезапуск сервисов

```powershell
cd "C:\Users\Umar\Desktop\Medicine project"
docker-compose down
docker-compose up -d
```

## 6. Доступ с других компьютеров

На другом компьютере в той же сети откройте браузер и перейдите по адресу:

```
http://192.168.1.100:5173
```

Замените `192.168.1.100` на реальный IP адрес компьютера-сервера.

## 7. Вход в систему

Используйте учетные данные:
- **Логин:** admin
- **Пароль:** admin123

## Проверка доступности

### С компьютера-сервера:
```powershell
# Проверка портов
netstat -an | findstr "5173"
netstat -an | findstr "8000"
netstat -an | findstr "8001"
```

### С другого компьютера:
```powershell
# Проверка ping
ping 192.168.1.100

# Проверка портов (если установлен telnet)
telnet 192.168.1.100 5173
```

## Устранение неполадок

### Проблема: Не удается подключиться

1. **Проверьте брандмауэр**: Убедитесь, что порты открыты
2. **Проверьте сеть**: Компьютеры должны быть в одной подсети
3. **Проверьте Docker**: `docker-compose ps` - все сервисы должны быть в статусе "Up"
4. **Проверьте логи**: `docker-compose logs frontend` и `docker-compose logs backend`

### Проблема: Сайт открывается, но API не работает

1. Убедитесь, что переменные `VITE_API_URL` и `VITE_WS_URL` используют правильный IP
2. Перезапустите frontend после изменения .env файла

### Проблема: WebSocket не подключается

1. Проверьте порт 8001 в файрволе
2. Проверьте что channels контейнер запущен: `docker-compose ps channels`

## Альтернативный способ (без Docker)

Если вы хотите запустить без Docker, используйте ngrok:

```powershell
# Установите ngrok
# Затем:
ngrok http 5173
```

Ngrok предоставит публичный URL, доступный из любой точки мира.

## Безопасность

⚠️ **ВАЖНО:** Для production использования:
1. Измените пароли по умолчанию
2. Настройте HTTPS
3. Используйте VPN для удаленного доступа
4. Настройте правильную аутентификацию
5. Ограничьте доступ к портам только для доверенных IP

## Поддержка

Если возникли проблемы, проверьте:
- Логи Docker: `docker-compose logs --tail=100`
- Консоль браузера (F12)
- Сетевые настройки Windows

