# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–ª–∞–¥–æ–≤ / Warehouse Setup

## –ü—Ä–æ–±–ª–µ–º–∞: "–°–∫–ª–∞–¥ –Ω–µ –≤–∏–¥–µ–Ω" –≤ —Ñ–æ—Ä–º–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞—Ä—Ç–∏–∏ —Ç–æ–≤–∞—Ä–∞

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ø–∞—Ä—Ç–∏—é —Ç–æ–≤–∞—Ä–∞ –ø–æ–ª–µ "–°–∫–ª–∞–¥" –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –Ω–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Å–∫–ª–∞–¥–æ–≤.

### –†–µ—à–µ–Ω–∏–µ

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –°–æ–∑–¥–∞—Ç—å —Å–∫–ª–∞–¥ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É **"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–ª–∞–¥–æ–º"**
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∫–ª–∞–¥–∫—É **"–°–∫–ª–∞–¥—ã"**
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üè¢ –°–∫–ª–∞–¥** –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **–§–∏–ª–∏–∞–ª**: –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª–∏–∞–ª, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –±—É–¥–µ—Ç –ø—Ä–∏–≤—è–∑–∞–Ω —Å–∫–ª–∞–¥
   - **–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∫–ª–∞–¥–∞**: –Ω–∞–ø—Ä–∏–º–µ—Ä, "–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫–ª–∞–¥", "–ê–ø—Ç–µ–∫–∞ ‚Ññ1", –∏ —Ç.–¥.
   - **–°—Ç–∞—Ç—É—Å**: –≤–∫–ª—é—á–∏—Ç–µ, —á—Ç–æ–±—ã —Å–∫–ª–∞–¥ –±—ã–ª –∞–∫—Ç–∏–≤–µ–Ω
5. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–∫–ª–∞–¥–∞ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —Ñ–æ—Ä–º–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞—Ä—Ç–∏–∏ —Ç–æ–≤–∞—Ä–∞ - –ø–æ–ª–µ "–°–∫–ª–∞–¥" —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ.

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–∑–¥–∞—Ç—å —Å–∫–ª–∞–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Ñ–∏–ª–∏–∞–ª—ã –≤ —Å–∏—Å—Ç–µ–º–µ, –≤—ã –º–æ–∂–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Ç—å –ø–æ –æ–¥–Ω–æ–º—É —Å–∫–ª–∞–¥—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞:

**–ù–∞ Windows (PowerShell):**
```powershell
cd backend
python manage.py create_default_warehouse
```

**–ù–∞ Linux/Mac:**
```bash
cd backend
python manage.py create_default_warehouse
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞—Å—Ç —Å–∫–ª–∞–¥ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º "–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫–ª–∞–¥ - [–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª–∏–∞–ª–∞]" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—â–µ –Ω–µ—Ç —Å–∫–ª–∞–¥–∞.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–í –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞—Ä—Ç–∏–∏ —Ç–æ–≤–∞—Ä–∞:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–∫–ª–∞–¥–æ–≤
- ‚úÖ –ü–æ–ª–µ "–°–∫–ª–∞–¥" –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è, –µ—Å–ª–∏ —Å–∫–ª–∞–¥–æ–≤ –Ω–µ—Ç
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∞ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π —Å–æ–∑–¥–∞–Ω–∏—è —Å–∫–ª–∞–¥–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∫–ª–∞–¥–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —Å–∫–ª–∞–¥–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
1. –í —Å–∏—Å—Ç–µ–º–µ —Å–æ–∑–¥–∞–Ω—ã —Ñ–∏–ª–∏–∞–ª—ã (–º–æ–¥—É–ª—å Organization)
2. –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ñ–∏–ª–∏–∞–ª—É
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ —Å–∏—Å—Ç–µ–º–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–∫–ª–∞–¥–∞:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–æ—Ä–º—É "–ù–æ–≤–∞—è –ø–∞—Ä—Ç–∏—è —Ç–æ–≤–∞—Ä–∞"
2. –ü–æ–ª–µ "–°–∫–ª–∞–¥" –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–∫–ª–∞–¥–æ–≤
3. –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å —Å–∫–ª–∞–¥ –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ú–æ–¥–µ–ª–∏:**
- `Warehouse` - –º–æ–¥–µ–ª—å —Å–∫–ª–∞–¥–∞ (–ø—Ä–∏–≤—è–∑–∞–Ω –∫ —Ñ–∏–ª–∏–∞–ª—É)
- `StockBatch` - –º–æ–¥–µ–ª—å –ø–∞—Ä—Ç–∏–∏ —Ç–æ–≤–∞—Ä–∞ (–ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ —Å–∫–ª–∞–¥—É –∏ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–µ)

**API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `GET /api/warehouse/warehouses/` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∫–ª–∞–¥–æ–≤
- `POST /api/warehouse/warehouses/` - —Å–æ–∑–¥–∞—Ç—å —Å–∫–ª–∞–¥
- `GET /api/warehouse/batches/` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–∞—Ä—Ç–∏–π
- `POST /api/warehouse/batches/` - —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä—Ç–∏—é —Ç–æ–≤–∞—Ä–∞

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:**
- –°–∫–ª–∞–¥—ã —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ú–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Ñ–∏–ª–∏–∞–ª—É: `/api/warehouse/warehouses/?branch=1`
- –ú–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Å—Ç–∞—Ç—É—Å—É: `/api/warehouse/warehouses/?is_active=true`

---

## Problem: "Warehouse not visible" in the new batch form

### Description
When trying to create a new stock batch, the "Warehouse" field may be empty or unavailable. This happens if there are no warehouses created in the system.

### Solution

#### Option 1: Create warehouse through the interface (recommended)

1. Go to the **"Warehouse Management"** page
2. Select the **"Warehouses"** tab
3. Click the **üè¢ Warehouse** button in the top right corner
4. Fill in the form:
   - **Branch**: select the branch to which the warehouse will be linked
   - **Warehouse name**: e.g., "Main warehouse", "Pharmacy #1", etc.
   - **Status**: enable it to make the warehouse active
5. Click **"Create"**

After creating the warehouse, return to the batch creation form - the "Warehouse" field will now be available.

#### Option 2: Create warehouses automatically via command

If you already have branches in the system, you can automatically create one warehouse for each branch:

**On Windows (PowerShell):**
```powershell
cd backend
python manage.py create_default_warehouse
```

**On Linux/Mac:**
```bash
cd backend
python manage.py create_default_warehouse
```

This command will create a warehouse named "Main warehouse - [Branch Name]" for each branch that doesn't have a warehouse yet.

### Additional improvements

In the updated batch creation form:
- ‚úÖ Added warning if no warehouses are available
- ‚úÖ "Warehouse" field is disabled if there are no warehouses
- ‚úÖ Added hint with warehouse creation instructions
- ‚úÖ Improved error handling when loading warehouses
- ‚úÖ Added logging for debugging

### Requirements

Before creating a warehouse, make sure that:
1. Branches are created in the system (Organization module)
2. The user has access rights to the selected branch
3. The user is authenticated in the system

### Verification

After creating a warehouse:
1. Open the "New stock batch" form
2. The "Warehouse" field should contain a list of available warehouses
3. You can select a warehouse from the dropdown list



